<Page x:Class="Biome.Desktop.App.Pages.SettingsPage"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:ui="http://schemas.lepo.co/wpfui/2022/xaml"
    Title="Settings"
    Foreground="{DynamicResource TextFillColorPrimaryBrush}"
    ScrollViewer.CanContentScroll="False">

    <Grid Margin="36, 24, 36, 24" 
          VerticalAlignment="Stretch" 
          Background="Transparent"
          PreviewMouseWheel="OnPageMouseWheel"
          MaxHeight="{Binding ActualHeight, RelativeSource={RelativeSource AncestorType=Frame}}">
        
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>

        <StackPanel Grid.Row="0" Margin="0,0,0,32">
            <ui:TextBlock FontTypography="TitleLarge" Text="Settings" />
            <ui:TextBlock FontTypography="Body" Foreground="{DynamicResource TextFillColorSecondaryBrush}" Text="Manage identity, cloud connection, and behavior." Margin="0,4,0,0"/>
        </StackPanel>

        <ScrollViewer x:Name="ContentScroll"
                  Grid.Row="1"
                  VerticalScrollBarVisibility="Auto"
                  HorizontalScrollBarVisibility="Disabled"
                  Padding="0,0,16,0"
                  Focusable="False"
                  CanContentScroll="False"
                  Background="Transparent">
            <StackPanel>
                
                <ui:TextBlock FontTypography="BodyStrong" Text="Connectivity" Foreground="{DynamicResource TextFillColorSecondaryBrush}" Margin="0,0,0,8"/>
                
                <ui:CardControl Icon="Laptop24" Margin="0,0,0,8">
                    <ui:CardControl.Header>
                        <StackPanel>
                            <ui:TextBlock FontTypography="BodyStrong" Text="Device Identity" />
                            <ui:TextBlock FontTypography="Caption" Foreground="{DynamicResource TextFillColorSecondaryBrush}" Text="Unique identifier for this machine." />
                        </StackPanel>
                    </ui:CardControl.Header>
                    <ui:TextBox x:Name="DeviceIdBox" IsReadOnly="True" Width="250" Icon="Copy24" PlaceholderText="Device ID" />
                </ui:CardControl>

                <ui:CardControl Icon="Cloud24" Margin="0,0,0,24">
                    <ui:CardControl.Header>
                        <StackPanel>
                            <ui:TextBlock FontTypography="BodyStrong" Text="Firebase Credentials" />
                            <ui:TextBlock FontTypography="Caption" Foreground="{DynamicResource TextFillColorSecondaryBrush}" Text="Service account JSON path." />
                        </StackPanel>
                    </ui:CardControl.Header>
                    <Grid Width="350">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="Auto"/>
                        </Grid.ColumnDefinitions>
                        <ui:TextBox x:Name="ConfigPathBox" Grid.Column="0" PlaceholderText="Path to json..." Margin="0,0,8,0" TextChanged="OnSettingChanged" />
                        <ui:Button Grid.Column="1"
                                   Click="BrowseConfig_Click"
                                   ToolTip="Browse for file"
                                   Padding="10,5"
                                   Height="{Binding ElementName=ConfigPathBox, Path=ActualHeight}">
                            <ui:SymbolIcon Symbol="Folder24" />
                        </ui:Button>

                    </Grid>
                </ui:CardControl>


                <ui:TextBlock FontTypography="BodyStrong" Text="Behavior" Foreground="{DynamicResource TextFillColorSecondaryBrush}" Margin="0,0,0,8"/>

                <ui:CardControl Icon="ArrowSync24" Margin="0,0,0,8">
                    <ui:CardControl.Header>
                        <StackPanel>
                            <ui:TextBlock FontTypography="BodyStrong" Text="Auto-Send Clipboard" />
                            <ui:TextBlock FontTypography="Caption" Foreground="{DynamicResource TextFillColorSecondaryBrush}" Text="Automatically upload content when copied." />
                        </StackPanel>
                    </ui:CardControl.Header>
                    <ui:ToggleSwitch IsChecked="False" IsEnabled="False" Content="Disabled (Coming Soon)" />
                </ui:CardControl>

                <ui:CardControl Icon="Flash24" Margin="0,0,0,24">
                    <ui:CardControl.Header>
                        <StackPanel>
                            <ui:TextBlock FontTypography="BodyStrong" Text="Speed Boost Animation" />
                            <ui:TextBlock FontTypography="Caption" Foreground="{DynamicResource TextFillColorSecondaryBrush}" Text="Show visual effect on transfer." />
                        </StackPanel>
                    </ui:CardControl.Header>
                    <StackPanel Orientation="Horizontal">
                        <ui:Button Content="Test" Click="TestAnimation_Click" Appearance="Secondary" Margin="0,0,8,0" />
                        <ui:ToggleSwitch x:Name="SpeedBoostToggle" IsChecked="True" Click="OnSettingChanged" />
                    </StackPanel>
                </ui:CardControl>


                <ui:TextBlock FontTypography="BodyStrong" Text="System Status" Foreground="{DynamicResource TextFillColorSecondaryBrush}" Margin="0,0,0,8"/>
                
                <ui:InfoBar x:Name="StatusInfoBar" 
                            Title="System Ready" 
                            Message="The background service is idling." 
                            Severity="Success" 
                            IsOpen="True" 
                            IsClosable="False" />

            </StackPanel>
        </ScrollViewer>

        <Border Grid.Row="2" Margin="0,12,0,0" BorderBrush="{DynamicResource SurfaceStrokeColorDefaultBrush}" BorderThickness="0,1,0,0" Padding="0,24,0,0">
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="Auto"/>
                </Grid.ColumnDefinitions>

                <StackPanel x:Name="UnsavedChangesWarning" Orientation="Horizontal" VerticalAlignment="Center" Visibility="Collapsed">
                    <ui:SymbolIcon Symbol="Warning24" Filled="True" Foreground="{DynamicResource SystemFillColorCautionBrush}" Margin="0,0,8,0"/>
                    <ui:TextBlock Text="You have unsaved changes." Foreground="{DynamicResource SystemFillColorCautionBrush}" VerticalAlignment="Center" FontTypography="BodyStrong"/>
                </StackPanel>

                <StackPanel Grid.Column="1" Orientation="Horizontal" HorizontalAlignment="Right">
                    <ui:Button Content="Reset" Appearance="Secondary" Click="Reset_Click" MinWidth="100" Margin="0,0,12,0"/>
                    <ui:Button Content="Save Changes" Appearance="Primary" Click="Save_Click" MinWidth="100"/>
                </StackPanel>
            </Grid>
        </Border>
    </Grid>
</Page>